<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Morse Translator</title>

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<style>
:root{
  --primary:#6750a4;
  --on-primary:#ffffff;
  --surface:#fef7ff;
  --surface-variant:#f3edf7;
  --outline:#e7e0ec;
  --ink:#1c1b1f;
  --radius:24px;
}

*{box-sizing:border-box;margin:0;padding:0}

body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:var(--surface);
  color:var(--ink);
}

.app{
  max-width:900px;
  margin:auto;
  padding:16px;
}

header{
  background:var(--surface-variant);
  padding:14px 16px;
  border-radius:var(--radius);
  display:flex;
  justify-content:space-between;
  align-items:center;
}

h1{
  font-size:18px;
  font-weight:600;
}

.btn{
  border:0;
  background:#ece6f6;
  padding:10px 14px;
  border-radius:999px;
  display:inline-flex;
  align-items:center;
  gap:6px;
  cursor:pointer;
  font-size:14px;
}

.btn.active{
  background:var(--primary);
  color:var(--on-primary);
}

.selector{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
  margin:16px 0;
}

.card{
  background:#fff;
  border-radius:var(--radius);
  padding:20px;
  border:1px solid var(--outline);
}

label{
  font-size:13px;
  font-weight:600;
  color:var(--primary);
  display:block;
  margin-bottom:8px;
}

textarea{
  width:100%;
  min-height:100px;
  padding:14px;
  border-radius:16px;
  border:1px solid var(--outline);
  font-size:15px;
  resize:vertical;
}

.actions{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin:16px 0;
}

.guide{
  margin-top:14px;
  padding:14px;
  border-radius:16px;
  background:var(--surface-variant);
  font-family:monospace;
  font-size:13px;
  white-space:pre-wrap;
}

.snack{
  position:fixed;
  bottom:24px;
  left:50%;
  transform:translateX(-50%);
  background:#2b2b2b;
  color:#fff;
  padding:10px 14px;
  border-radius:12px;
  opacity:0;
  transition:.25s;
}

.snack.show{opacity:1}

@media(max-width:520px){
  .selector{grid-template-columns:1fr}
}
</style>
</head>

<body>
<div class="app">

<header>
  <h1>Morse Translator</h1>
  <button class="btn" id="btn-guide">
    <i class="material-icons">help_outline</i>Guia
  </button>
</header>

<div class="selector">
  <button class="btn active" id="btn-t2m">
    <i class="material-icons">text_fields</i>Texto → Morse
  </button>
  <button class="btn" id="btn-m2t">
    <i class="material-icons">dashboard</i>Morse → Texto
  </button>
</div>

<section class="card">
  <label id="label-input">Digite o texto</label>
  <textarea id="input" placeholder="Ex: SOS"></textarea>

  <div class="actions">
    <button class="btn" id="btn-play">
      <i class="material-icons">volume_up</i>Reproduzir
    </button>
    <button class="btn" id="btn-copy">
      <i class="material-icons">content_copy</i>Copiar
    </button>
    <button class="btn" id="btn-clear">
      <i class="material-icons">clear</i>Limpar
    </button>
  </div>

  <label id="label-output">Código Morse</label>
  <textarea id="output" readonly placeholder="Resultado"></textarea>

  <div class="guide" id="guide-box" style="display:none">
. = 200ms
- = 600ms
Pausa símbolo = 200ms
Pausa letra = 600ms
Pausa palavra = 1000ms
Use "/" para palavras
  </div>
</section>

</div>

<div class="snack" id="snack"></div>

<script>
const DOT=200, DASH=600, S=200, L=600, W=1000;

const MAP={
A:".-",B:"-...",C:"-.-.",D:"-..",E:".",F:"..-.",G:"--.",H:"....",
I:"..",J:".---",K:"-.-",L:".-..",M:"--",N:"-.",O:"---",
P:".--.",Q:"--.-",R:".-.",S:"...",T:"-",U:"..-",V:"...-",
W:".--",X:"-..-",Y:"-.--",Z:"--..",
"0":"-----","1":".----","2":"..---","3":"...--","4":"....-",
"5":".....","6":"-....","7":"--...","8":"---..","9":"----."
};

const REV=Object.fromEntries(Object.entries(MAP).map(e=>[e[1],e[0]]));
REV["/"]=" ";

const $=id=>document.getElementById(id);
let dir="t2m", ctx;

$("input").oninput=()=>update();

function update(){
  $("output").value =
    dir==="t2m"
    ? [...$("input").value.toUpperCase()].map(c=>c===" "?" / ":MAP[c]||"?").join(" ")
    : $("input").value.trim().split(/\s+/).map(c=>REV[c]||"?").join("");
}

$("btn-t2m").onclick=()=>setDir("t2m");
$("btn-m2t").onclick=()=>setDir("m2t");

function setDir(d){
  dir=d;
  $("btn-t2m").classList.toggle("active",d==="t2m");
  $("btn-m2t").classList.toggle("active",d==="m2t");
  $("label-input").textContent=d==="t2m"?"Digite o texto":"Digite o código Morse";
  $("label-output").textContent=d==="t2m"?"Código Morse":"Texto traduzido";
  update();
}

$("btn-play").onclick=async()=>{
  if(!$("output").value) return msg("Nada pra tocar");
  ctx ??= new AudioContext();
  for(const word of $("output").value.split(" ")){
    if(word==="/"){await pause(W);continue;}
    for(const c of word){
      tone(c==="."?DOT:DASH);
      await pause(c==="."?DOT:DASH);
      await pause(S);
    }
    await pause(L);
  }
};

function tone(ms){
  const o=ctx.createOscillator(), g=ctx.createGain();
  o.connect(g); g.connect(ctx.destination);
  g.gain.value=0.25; o.start(); o.stop(ctx.currentTime+ms/1000);
}

const pause=ms=>new Promise(r=>setTimeout(r,ms));

$("btn-clear").onclick=()=>($("input").value="",$("output").value="");
$("btn-copy").onclick=async()=>{await navigator.clipboard.writeText($("output").value);msg("Copiado")};
$("btn-guide").onclick=()=>$("guide-box").style.display=
  $("guide-box").style.display==="none"?"block":"none";

function msg(t){
  const s=$("snack"); s.textContent=t; s.classList.add("show");
  setTimeout(()=>s.classList.remove("show"),2200);
}
</script>
</body>
</html>